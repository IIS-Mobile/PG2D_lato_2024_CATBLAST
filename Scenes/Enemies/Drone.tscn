[gd_scene load_steps=47 format=3 uid="uid://d1rxkgas26uuw"]

[ext_resource type="Script" path="res://Scripts/Enemies/Drone/drone.gd" id="1_kaeg1"]
[ext_resource type="Shader" path="res://Shaders/drone_effect.gdshader" id="2_4ryb3"]
[ext_resource type="Texture2D" uid="uid://do1yflijhcwyu" path="res://Assets/Arts/Animations/enemy_animations/drone/drone_start_attack.png" id="2_h8w1r"]
[ext_resource type="Texture2D" uid="uid://cpkulf7m2gntj" path="res://Assets/Arts/Animations/enemy_animations/drone/drone_idle.png" id="2_lf7iw"]
[ext_resource type="Texture2D" uid="uid://bqu0k1yt1miv" path="res://Assets/Arts/Animations/enemy_animations/drone/drone_death.png" id="3_g0dfy"]
[ext_resource type="Texture2D" uid="uid://b5g4rxduvjmbd" path="res://Assets/Arts/Animations/enemy_animations/drone/drone_shot.png" id="3_l5frq"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ymvw2"]
size = Vector2(3.62319, 3.62612)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_tab2y"]
resource_local_to_scene = true
shader = ExtResource("2_4ryb3")
shader_parameter/heat_intensity = 0.0
shader_parameter/amplitude = 25.0
shader_parameter/speed = 2.0

[sub_resource type="AtlasTexture" id="AtlasTexture_jonyv"]
atlas = ExtResource("2_h8w1r")
region = Rect2(0, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_inrsw"]
atlas = ExtResource("2_h8w1r")
region = Rect2(64, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_o4nh8"]
atlas = ExtResource("2_h8w1r")
region = Rect2(128, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_63o1p"]
atlas = ExtResource("2_h8w1r")
region = Rect2(192, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_bio6b"]
atlas = ExtResource("3_g0dfy")
region = Rect2(0, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_8a1a5"]
atlas = ExtResource("3_g0dfy")
region = Rect2(64, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_xnrnc"]
atlas = ExtResource("3_g0dfy")
region = Rect2(128, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_o6kd5"]
atlas = ExtResource("3_g0dfy")
region = Rect2(192, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_owf2m"]
atlas = ExtResource("3_g0dfy")
region = Rect2(256, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_0dw1v"]
atlas = ExtResource("3_g0dfy")
region = Rect2(320, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_1kkfb"]
atlas = ExtResource("3_g0dfy")
region = Rect2(384, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_6sb65"]
atlas = ExtResource("2_lf7iw")
region = Rect2(64, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_0lb0d"]
atlas = ExtResource("2_lf7iw")
region = Rect2(128, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_skbth"]
atlas = ExtResource("2_lf7iw")
region = Rect2(192, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_0u2ec"]
atlas = ExtResource("2_lf7iw")
region = Rect2(0, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_v1qqs"]
atlas = ExtResource("3_l5frq")
region = Rect2(0, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_a7b1l"]
atlas = ExtResource("3_l5frq")
region = Rect2(64, 0, 64, 64)

[sub_resource type="SpriteFrames" id="SpriteFrames_5l1ra"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_jonyv")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_inrsw")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_o4nh8")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_63o1p")
}],
"loop": false,
"name": &"charge",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_bio6b")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8a1a5")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_xnrnc")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_o6kd5")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_owf2m")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_0dw1v")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_1kkfb")
}],
"loop": false,
"name": &"death",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_6sb65")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_0lb0d")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_skbth")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_0u2ec")
}],
"loop": false,
"name": &"idle",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_v1qqs")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_a7b1l")
}],
"loop": false,
"name": &"shoot",
"speed": 5.0
}]

[sub_resource type="Animation" id="Animation_fxg6c"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimatedSprite2D:animation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [&"idle"]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("AnimatedSprite2D:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("AnimatedSprite2D:material:shader_parameter/heat_intensity")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}

[sub_resource type="Animation" id="Animation_32onl"]
resource_name = "charge"
length = 1.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimatedSprite2D:animation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [&"charge"]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("AnimatedSprite2D:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.3, 0.6, 0.9),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [0, 1, 2, 3]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("AnimatedSprite2D:material:shader_parameter/heat_intensity")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 1.2),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.0, 1.0]
}

[sub_resource type="Animation" id="Animation_aehfr"]
resource_name = "death"
length = 1.4
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimatedSprite2D:animation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [&"death"]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("AnimatedSprite2D:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6, 0.8, 1, 1.2),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [0, 1, 2, 3, 4, 5, 6]
}
tracks/2/type = "method"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath(".")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0.6),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [],
"method": &"explosion_damage"
}]
}

[sub_resource type="Animation" id="Animation_sl2v7"]
resource_name = "idle"
length = 1.2
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimatedSprite2D:animation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [&"idle"]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("AnimatedSprite2D:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.3, 0.6, 0.9),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [0, 1, 2, 3]
}

[sub_resource type="Animation" id="Animation_43hx6"]
resource_name = "shoot"
length = 0.6
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimatedSprite2D:animation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [&"shoot"]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("AnimatedSprite2D:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.3),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [0, 1]
}
tracks/2/type = "method"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath(".")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [],
"method": &"spawn_laser"
}]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_ha7mj"]
_data = {
"RESET": SubResource("Animation_fxg6c"),
"charge": SubResource("Animation_32onl"),
"death": SubResource("Animation_aehfr"),
"idle": SubResource("Animation_sl2v7"),
"shoot": SubResource("Animation_43hx6")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3vwxa"]
animation = &"charge"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_bt52y"]
animation = &"death"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_n4vse"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ogtai"]
animation = &"shoot"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_btsiw"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_hxejx"]
advance_mode = 2
advance_condition = &"shoot"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_adn7q"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_v5mew"]
switch_mode = 2
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_nir2w"]
advance_mode = 2
advance_condition = &"death"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fgugd"]
advance_mode = 2
advance_condition = &"death"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_878ky"]
advance_mode = 2
advance_condition = &"death"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ds3hl"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_5qgkj"]
states/End/position = Vector2(883, 175)
states/Start/position = Vector2(117, 100)
states/charge/node = SubResource("AnimationNodeAnimation_3vwxa")
states/charge/position = Vector2(506, 31)
states/death/node = SubResource("AnimationNodeAnimation_bt52y")
states/death/position = Vector2(552, 239)
states/idle/node = SubResource("AnimationNodeAnimation_n4vse")
states/idle/position = Vector2(405, 110)
states/shoot/node = SubResource("AnimationNodeAnimation_ogtai")
states/shoot/position = Vector2(613, 123)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_btsiw"), "idle", "charge", SubResource("AnimationNodeStateMachineTransition_hxejx"), "charge", "shoot", SubResource("AnimationNodeStateMachineTransition_adn7q"), "shoot", "idle", SubResource("AnimationNodeStateMachineTransition_v5mew"), "idle", "death", SubResource("AnimationNodeStateMachineTransition_nir2w"), "charge", "death", SubResource("AnimationNodeStateMachineTransition_fgugd"), "shoot", "death", SubResource("AnimationNodeStateMachineTransition_878ky"), "death", "End", SubResource("AnimationNodeStateMachineTransition_ds3hl")]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_oana1"]
radius = 35.0
height = 70.0

[node name="Drone" type="CharacterBody2D" groups=["metal_enemy"]]
z_index = 3
collision_layer = 9
motion_mode = 1
script = ExtResource("1_kaeg1")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
visible = false
position = Vector2(1.58946e-06, -5)
scale = Vector2(9.2, 9.97405)
shape = SubResource("RectangleShape2D_ymvw2")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
material = SubResource("ShaderMaterial_tab2y")
position = Vector2(2, 0)
sprite_frames = SubResource("SpriteFrames_5l1ra")
animation = &"idle"

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_ha7mj")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
active = false
tree_root = SubResource("AnimationNodeStateMachine_5qgkj")
anim_player = NodePath("../AnimationPlayer")
parameters/conditions/death = false
parameters/conditions/idle = false
parameters/conditions/shoot = false

[node name="Hitbox" type="Area2D" parent="." groups=["enemy"]]
collision_layer = 8
collision_mask = 10

[node name="ExplosionCollisionShape" type="CollisionShape2D" parent="Hitbox"]
position = Vector2(0, -6)
shape = SubResource("CapsuleShape2D_oana1")
disabled = true

[node name="RayCast2D" type="RayCast2D" parent="."]
position = Vector2(1, 0)
target_position = Vector2(100, 0)
collision_mask = 3
hit_from_inside = true

[connection signal="animation_finished" from="AnimationTree" to="." method="_on_animation_tree_animation_finished"]
[connection signal="animation_started" from="AnimationTree" to="." method="_on_animation_tree_animation_started"]
